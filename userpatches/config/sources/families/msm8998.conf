# Activate needed extensions for this family (order is not important)
enable_extension "fastboot_image"
enable_extension "initramfs_usb_gadget"

declare -g LINUXFAMILY=msm8998
declare -g ARCH=arm64
declare -g PACKAGE_LIST_FAMILY="mkbootimg" # mkbootimg for creating fastboot compatible kernel.gz+dtb+initrd+cmdline+offset bundle

# Bootloader related, ripped from pmos deviceinfo file. @TODO: create an extension that imports those from a deviceinfo URL (with caching)
# TODO: see https://gitlab.com/postmarketOS/pmaports/-/blob/master/device/testing/device-oneplus-cheeseburger/deviceinfo

declare -g deviceinfo_kernel_cmdline="cmdline_from=pmOS not_used=at_all clk_ignore_unused modprobe.blacklist=ipa" # We need 'clk_ignore_unused' for now or we don't get graphics
declare -g deviceinfo_flash_offset_base="0x00000000"
declare -g deviceinfo_flash_offset_kernel="0x00008000"
declare -g deviceinfo_flash_offset_ramdisk="0x01000000"
declare -g deviceinfo_flash_offset_second="0x00f00000"
declare -g deviceinfo_flash_offset_tags="0x00000100"
declare -g deviceinfo_flash_pagesize="4096"
declare -g deviceinfo_flash_sparse="true"

case $BRANCH in
	edge)
		declare -g KERNEL_MAJOR_MINOR="6.1" # Major and minor versions of this kernel
		#declare -g KERNELBRANCH='branch:linux-6.1.y'
		declare -g KERNELBRANCH='tag:v6.1.1' # 6.1.2 already has pretty gnarly changes that I can't rebase against; v6.1.1 builds ok
		declare -g KERNELDIR='linux-msm8998-edge'
		declare -g KERNELPATCHDIR='msm8998-edge'
		declare -g EXTRAWIFI="no"
		;;

	# legacy: https://github.com/LineageOS/android_kernel_oneplus_msm8998  (4.4.y)
esac
